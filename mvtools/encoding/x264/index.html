
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Various guides on encoding by JET">
      
      
        <meta name="author" content="Jaded Encoding Thaumaturgy">
      
      
        <link rel="canonical" href="https://jaded-encoding-thaumaturgy.github.io/JET-guide/mvtools/encoding/x264/">
      
      
        <link rel="prev" href="../../filtering/situational/dehardsubbing/">
      
      
        <link rel="next" href="../x265/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>x264 - JET Encoding Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#x264-parameters" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="JET Encoding Guide" class="md-header__button md-logo" aria-label="JET Encoding Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            JET Encoding Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              x264
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Jaded-Encoding-Thaumaturgy/JET-Guide" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="JET Encoding Guide" class="md-nav__button md-logo" aria-label="JET Encoding Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    JET Encoding Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Jaded-Encoding-Thaumaturgy/JET-Guide" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/python-primer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python Primer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/how-do-i/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How do I...?
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Source Preparation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Source Preparation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DVDs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            DVDs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sources/dvd/remuxing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Remuxing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://wobbly.encode.moe" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wobbly ðŸ¡•
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Filtering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Filtering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    General Techniques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            General Techniques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filtering/general/order/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Order of Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filtering/general/expressions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expressions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Common Filtering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Common Filtering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2_1" >
        
          
          <label class="md-nav__link" for="__nav_4_2_1" id="__nav_4_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Denoising
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_1">
            <span class="md-nav__icon md-icon"></span>
            Denoising
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filtering/common/denoising/mvtools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MVTools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2_2" id="__nav_4_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Descaling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            Descaling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filtering/common/descaling/theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filtering/common/descaling/known-resolutions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Known Resolutions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Situational Filtering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Situational Filtering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filtering/situational/dehardsubbing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dehardsubbing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Encoding
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Encoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    x264
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    x264
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-settings" class="md-nav__link">
    <span class="md-ellipsis">
      General settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preset" class="md-nav__link">
    <span class="md-ellipsis">
      Preset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#level" class="md-nav__link">
    <span class="md-ellipsis">
      Level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motion-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Motion estimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ratecontrol-lookahead" class="md-nav__link">
    <span class="md-ellipsis">
      Ratecontrol lookahead
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-specific-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Source-specific settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Source-specific settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ratecontrol" class="md-nav__link">
    <span class="md-ellipsis">
      Ratecontrol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ratecontrol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constant-ratefactor" class="md-nav__link">
    <span class="md-ellipsis">
      Constant ratefactor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-pass" class="md-nav__link">
    <span class="md-ellipsis">
      Two pass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Two pass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chroma-quantizer-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Chroma quantizer offset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deblock" class="md-nav__link">
    <span class="md-ellipsis">
      Deblock
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantizer-curve-compression" class="md-nav__link">
    <span class="md-ellipsis">
      Quantizer curve compression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macroblock-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Macroblock tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adaptive-quantization" class="md-nav__link">
    <span class="md-ellipsis">
      Adaptive quantization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adaptive quantization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aq-dark-bias-strength" class="md-nav__link">
    <span class="md-ellipsis">
      AQ dark bias strength
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motion-estimation-range" class="md-nav__link">
    <span class="md-ellipsis">
      Motion estimation range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frame-type-quantizer-ratio" class="md-nav__link">
    <span class="md-ellipsis">
      Frame type quantizer ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psychovisually-optimized-rate-distortion-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Psychovisually optimized rate-distortion optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dct-block-decimation" class="md-nav__link">
    <span class="md-ellipsis">
      DCT block decimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#video-buffer-verifier" class="md-nav__link">
    <span class="md-ellipsis">
      Video buffer verifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Reference frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zones" class="md-nav__link">
    <span class="md-ellipsis">
      Zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-depth-and-color-space" class="md-nav__link">
    <span class="md-ellipsis">
      Output depth and color space
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../x265/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    x265
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Additional Resources
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-settings" class="md-nav__link">
    <span class="md-ellipsis">
      General settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preset" class="md-nav__link">
    <span class="md-ellipsis">
      Preset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#level" class="md-nav__link">
    <span class="md-ellipsis">
      Level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motion-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Motion estimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ratecontrol-lookahead" class="md-nav__link">
    <span class="md-ellipsis">
      Ratecontrol lookahead
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-specific-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Source-specific settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Source-specific settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ratecontrol" class="md-nav__link">
    <span class="md-ellipsis">
      Ratecontrol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ratecontrol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constant-ratefactor" class="md-nav__link">
    <span class="md-ellipsis">
      Constant ratefactor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-pass" class="md-nav__link">
    <span class="md-ellipsis">
      Two pass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Two pass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chroma-quantizer-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Chroma quantizer offset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deblock" class="md-nav__link">
    <span class="md-ellipsis">
      Deblock
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantizer-curve-compression" class="md-nav__link">
    <span class="md-ellipsis">
      Quantizer curve compression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macroblock-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Macroblock tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adaptive-quantization" class="md-nav__link">
    <span class="md-ellipsis">
      Adaptive quantization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adaptive quantization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aq-dark-bias-strength" class="md-nav__link">
    <span class="md-ellipsis">
      AQ dark bias strength
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#motion-estimation-range" class="md-nav__link">
    <span class="md-ellipsis">
      Motion estimation range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frame-type-quantizer-ratio" class="md-nav__link">
    <span class="md-ellipsis">
      Frame type quantizer ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psychovisually-optimized-rate-distortion-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Psychovisually optimized rate-distortion optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dct-block-decimation" class="md-nav__link">
    <span class="md-ellipsis">
      DCT block decimation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#video-buffer-verifier" class="md-nav__link">
    <span class="md-ellipsis">
      Video buffer verifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Reference frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zones" class="md-nav__link">
    <span class="md-ellipsis">
      Zones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-depth-and-color-space" class="md-nav__link">
    <span class="md-ellipsis">
      Output depth and color space
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="x264-parameters">x264 Parameters</h1>
<h2 id="general-settings">General settings</h2>
<p>These are the settings that you shouldn't touch between encodes.</p>
<h3 id="preset">Preset</h3>
<p>Presets apply a number of parameters, which can be referenced <a href="https://dev.beandog.org/x264_preset_reference.html">here</a>
Just use the placebo preset, we'll change the really slow stuff, anyway:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>--preset<span style="color: #ABB2BF"> </span>placebo
</code></pre></div></td></tr></table></div>
<h3 id="level">Level</h3>
<p>Where --preset applies a defined set of parameters, --level provides a set of limitations to ensure decoder compatibility. For further reading, see this <a href="https://en.wikipedia.org/wiki/Advanced_Video_Coding#Levels">Wikipedia article</a></p>
<p>For general hardware support level 4.1 is recommended, otherwise you may omit this.</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>--level<span style="color: #ABB2BF"> </span><span style="color: #D19A66">41</span>
</code></pre></div></td></tr></table></div>
<h3 id="motion-estimation">Motion estimation</h3>
<p>For further reading <a href="https://web.archive.org/web/20210516085632/https://forum.doom9.org/showthread.php?p=1789660">see this excellent thread on Doom9</a></p>
<p>x264 has two motion estimation algorithms worth using, umh and tesa.
The latter is a placebo option that's really, really slow, and seldom yields better results, so only use it if you don't care about encode time.
Otherwise, just default to umh:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>--me<span style="color: #ABB2BF"> </span>umh
</code></pre></div></td></tr></table></div>
<h3 id="ratecontrol-lookahead">Ratecontrol lookahead</h3>
<p>The ratecontrol lookahead (rc-lookahead) setting determines how far ahead the video buffer verifier (VBV) and macroblock tree (mbtree) can look.
Raising this can slightly increase memory use, but it's generally best to leave this as high as possible:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>--rc-lookahead<span style="color: #ABB2BF"> </span><span style="color: #D19A66">250</span>
</code></pre></div></td></tr></table></div>
<p>If you're low on memory, you can lower it to e.g. 60.</p>
<h2 id="source-specific-settings">Source-specific settings</h2>
<p>These settings should be tested and/or adjusted for every encode.</p>
<h3 id="ratecontrol">Ratecontrol</h3>
<p>Beyond all else, this is the single most important factor for determining the quality from any given input. Due to how poorly x264 handles lower bitrates (comparatively, particularly when encoding 8-bit) starving your encode will result in immediate artifacts observable even under the lightest scrutiny.</p>
<p>While manipulating other settings may make small, but usually noticeable differences; an encode can't look great unless given enough bits.</p>
<p>For some further insight, reference <a href="https://github.com/jpsdr/x264/blob/master/doc/ratecontrol.txt">this article</a></p>
<h4 id="constant-ratefactor">Constant ratefactor</h4>
<p>For more information please see <a href="https://forum.doom9.org/showthread.php?p=1261917#post1261917">this post by an x264 developer</a>.</p>
<p>The constant ratefactor (CRF) is the suggested mode for encoding.
Rather than specifying a target bitrate, CRF attempts to ensure a consistent quality across a number of frames; as such, the resulting bitrate will only be consistent if passed identical values.
In short, CRF is recommended for use with your finalized encode, not testing, where two pass is recommended.</p>
<p>Lower CRF values are higher quality, higher values lower.
Some settings will have a very large effect on the bitrate at a constant CRF, so it's hard to recommend a CRF range, but most encodes will use a value between 15.0 and 20.0.
It's best to test your CRF first to find an ideal bitrate, then test it again after all other settings have been tested with 2pass.</p>
<p>To specify CRF:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>--crf<span style="color: #ABB2BF"> </span><span style="color: #D19A66">16</span>.9
</code></pre></div></td></tr></table></div>
<h4 id="two-pass">Two pass</h4>
<p>An alternative to CRF which leverages an initial pass to collect information about the input before encoding. This comes with two distinct advantages:</p>
<ul>
<li>The ability to target a specific bitrate</li>
<li>Effectively infinite lookahead</li>
</ul>
<p>This is very suitable for testing settings, as you will always end up at almost the same bitrate no matter what.</p>
<p>As mentioned previously, to encode this two runs are necessary. The first pass can be sent to /dev/null, since all we care about is the stats file.
To specify which of the two passes you're encoding all we need to change is <code>--pass</code></p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>vspipe<span style="color: #ABB2BF"> </span>-c<span style="color: #ABB2BF"> </span>y4m<span style="color: #ABB2BF"> </span>script.vpy<span style="color: #ABB2BF"> </span>-<span style="color: #ABB2BF"> | </span>x264<span style="color: #ABB2BF"> </span>--demuxer<span style="color: #ABB2BF"> </span>y4m<span style="color: #ABB2BF"> </span>--preset<span style="color: #ABB2BF"> </span>placebo<span style="color: #ABB2BF"> </span>--pass<span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> </span>--bitrate<span style="color: #ABB2BF"> </span><span style="color: #D19A66">8500</span><span style="color: #ABB2BF"> </span>-o<span style="color: #ABB2BF"> </span>/dev/null<span style="color: #ABB2BF"> </span>-
</code></pre></div></td></tr></table></div>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>vspipe<span style="color: #ABB2BF"> </span>-c<span style="color: #ABB2BF"> </span>y4m<span style="color: #ABB2BF"> </span>script.vpy<span style="color: #ABB2BF"> </span>-<span style="color: #ABB2BF"> | </span>x264<span style="color: #ABB2BF"> </span>--demuxer<span style="color: #ABB2BF"> </span>y4m<span style="color: #ABB2BF"> </span>--preset<span style="color: #ABB2BF"> </span>placebo<span style="color: #ABB2BF"> </span>--pass<span style="color: #ABB2BF"> </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF"> </span>--bitrate<span style="color: #ABB2BF"> </span><span style="color: #D19A66">8500</span><span style="color: #ABB2BF"> </span>-o<span style="color: #ABB2BF"> </span>out.h264<span style="color: #ABB2BF"> </span>-
</code></pre></div></td></tr></table></div>
<h5 id="chroma-quantizer-offset">Chroma quantizer offset</h5>
<p>If you're struggling with chroma getting overly distorted, it can be worth tinkering with this option.
You can find examples of what bitstarved chroma can look like <a href="https://silentaperture.gitlab.io/mdbook-guide/encoding/images/godfather_road_sky.png">HERE</a> and <a href="https://silentaperture.gitlab.io/mdbook-guide/encoding/images/godfather_plane_split.png">HERE</a>.
Lower values give more bits to chroma, higher values will take away.
By default, this will be -2 for 4:2:0 and 6 for 4:4:4.
Setting this will add your offset onto -2.</p>
<p>To lower the chroma QP offset from -2 to -3, granting chroma more bits:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>--chroma-qp-offset<span style="color: #ABB2BF"> </span>-1
</code></pre></div></td></tr></table></div>
<h3 id="deblock">Deblock</h3>
<p>For an explanation of what deblock does, read <a href="https://forum.doom9.org/showthread.php?p=1692393#post1692393">this Doom9 post</a> and <a href="https://web.archive.org/web/20220323033558/https://huyunf.github.io/blogs/2017/11/20/h264_deblocking_algorithm/">this blog post</a></p>
<p>Set this too high and you'll have a blurry encode, set it too low and you'll have an overly blocky encode.
We recommend testing deblock in a range of <code>-2:-2</code> to <code>0:0</code> (animated content should use stronger deblock settings).
Usually, you can test this with the same alpha and beta parameters at first, then test offsets of Â±1.</p>
<p>Many people will mindlessly use -3:-3, but this tends to lead to unnecessary blocking that could've been avoided had this setting been tested.</p>
<p>To specify e.g. an alpha of -2 and a beta of -1:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>--deblock<span style="color: #ABB2BF"> </span>-2:-1
</code></pre></div></td></tr></table></div>
<h3 id="quantizer-curve-compression">Quantizer curve compression</h3>
<p>The quantizer curve compression (qcomp) is effectively the setting that determines how bits are distributed among the whole encode.
It has a range of 0 to 1, where 0 is a constant bitrate and 1 is a constant quantizer, the opposite of a constant bitrate.
This means qcomp affects how much bitrate you're giving to "important" scenes as opposed to "unimportant" scenes.
In other words, it can be seen as the trade-off between bitrate allocation to simple or static scenes and complex or high motion scenes.
Higher qcomp will allocate more to the latter, lower to the former.</p>
<p>It's usually recommended to set this between <code>0.60</code> and <code>0.70</code> without mbtree and <code>0.70</code> and <code>0.85</code> with mbtree.
You want to find that sweet spot where complex scenes will look good enough without ruining simple scenes.</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>--qcomp<span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span>.60
</code></pre></div></td></tr></table></div>
<h3 id="macroblock-tree">Macroblock tree</h3>
<p>From <a href="https://forum.doom9.org/showthread.php?t=148686">this thread by an x264 developer</a>: "It tracks the propagation of information from future blocks to past blocks across motion vectors. It could be described as localizing qcomp to act on individual blocks instead of whole scenes. Thus instead of lowering quality in high-complexity scenes (like x264 currently does), it'll only lower quality on the complex part of the scene, while for example a static background will remain high-quality. It also has many other more subtle effects, some potentially negative, most probably not."</p>
<p>Curious readers can reference the <a href="https://archive.org/download/x264_mbtree/x264_mbtree.pdf">paper directly</a></p>
<p>Macroblock tree ratecontrol (mbtree) can lead to large savings for very flat content, but tends to be destructive on anything with a decent amount of grain.
If you're encoding something with very little movement and variation, especially cartoons and less grainy digital anime, it's recommended to test this setting to see if it's worth it.</p>
<p>When using mbtree, you should max out your lookahead (<code>--rc-lookahead 250</code>) and use a high qcomp â‰¥0.70.</p>
<h3 id="adaptive-quantization">Adaptive quantization</h3>
<p>While qcomp determines bit allocation for frames across the video, adaptive quantization (AQ) can be seen as in charge of doing this on a block-basis, i.e. throughout a frame.
It does so by distributing bits from higher contrast areas to lower contrast regions.
This is done because, while lower contrast areas are mathematically less significant, the human eye considers them of equal importance.</p>
<p>For more on this, the explanation in <a href="https://gitlab.com/AOMediaCodec/SVT-AV1/-/blob/master/Docs/Appendix-Variance-Boost.md">this document</a> is quite helpful.
<a href="https://huyunf.github.io/blogs/2017/12/06/x264_adaptive_quant/">This post</a> grants a bit of insight on the implementation in x264.</p>
<p>There are three modes available in vanilla x264:</p>
<ol>
<li>Allow AQ to redistribute bits across the whole video and within frames.</li>
<li>Auto-variance; this attempts to adapt strength per-frame.</li>
<li>Auto-variance with a bias to dark scenes.</li>
</ol>
<p>Generally speaking, you'll likely get the best results with AQ mode 3.
With the other two modes, you have to carefully make sure that darks aren't being damaged too much.
If you e.g. have a source without any dark scenes (or only very few), it can be worth manually allocating more bits to darks via <a href="#zones">zoning</a> and using AQ modes 1 or 2.</p>
<p>This comes along with a strength parameter.
For modes 1 and 2, you usually want a strength between 0.80 and 1.30.
Mode 3 is a bit more aggressive and usually looks best with a strength between 0.60 and 0.85.</p>
<p>Raising the AQ strength will help flatter areas, e.g. by maintaining smaller grain and dither to alleviate banding.
However, higher AQ strengths will tend to distort edges more.</p>
<p>Older, grainier live action content will usually benefit more from lower AQ strengths and may benefit less from the dark scene bias present in AQ mode 3, while newer live action tends to benefit more from higher values.
For animation, this setting can be very tricky; as both banding and distorted edges are more noticeable.
It's usually recommended to run a slightly lower AQ strength, e.g. around 0.60 to 0.70 with mode 3.</p>
<p>To use e.g. AQ mode 3 with strength 0.80:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>--aq-mode<span style="color: #ABB2BF"> </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF"> </span>--aq-strength<span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span>.80
</code></pre></div></td></tr></table></div>
<h4 id="aq-dark-bias-strength">AQ dark bias strength</h4>
<p>Some mods now include a parameter to control AQ mode 3's bias to dark scenes strength.
With this, the dark bias strength is a multiple of the AQ strength, meaning higher bias strength raises the dark bias and lower bias strength trends towards AQ mode 2.</p>
<p>This can be very useful in cases where you want to give more or fewer bits to darks without affecting the AQ strength.
To apply an AQ dark bias strength of 1.00:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>--aq-mode<span style="color: #ABB2BF"> </span><span style="color: #D19A66">3</span><span style="color: #ABB2BF"> </span>--aq-bias-strength<span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span>.00
</code></pre></div></td></tr></table></div>
<h3 id="motion-estimation-range">Motion estimation range</h3>
<p>The motion estimation range (merange) determines how many pixels are used for motion estimation.
Larger numbers will be slower, but can be more accurate for higher resolutions.
However, go too high, and the encoder will start picking up unwanted info, which in turn will harm coding efficiency.
You can usually get by with testing <code>32</code>, <code>48</code>, and <code>64</code>, then using the best looking one, preferring lower numbers if equivalent:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>--merange<span style="color: #ABB2BF"> </span><span style="color: #D19A66">32</span>
</code></pre></div></td></tr></table></div>
<h3 id="frame-type-quantizer-ratio">Frame type quantizer ratio</h3>
<p>To understand this parameter, one needs to know what the different frame types are.
The <a href="https://en.wikipedia.org/wiki/Video_compression_picture_types">Wikipedia article</a> on this subject is very useful for this.</p>
<p>These settings determine how bits are distributed among the different frame types.
Generally speaking, you want to have an I-frame to P-frame ratio (ipratio) around 0.10 higher than your P-frame to B-frame ratio (pbratio).
Usually, you'll want to lower these from the defaults of <code>1.40</code> for ipratio and <code>1.30</code> for pbratio, although not by more than 20.</p>
<p>Lower ratios will tend to help with grainier content, where less information from previous frames can be used, while higher ratios will usually lead to better results with flatter content.</p>
<p>You can use the stats created by the x264 log at the end of the encoding process to check whether the encoder is over-allocating bits to a certain frame type and investigate whether this is a problem.
A good guideline is for P-frames to be double the size of B-frames and I-frames in turn be double the size of P-frames.
However, don't just blindly set your ratios so that this is the case.
Always use your eyes.</p>
<p>To set an ipratio of <code>1.30</code> and a pbratio of <code>1.20</code>:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a>--ipratio<span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span>.30<span style="color: #ABB2BF"> </span>--pbratio<span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span>.20
</code></pre></div></td></tr></table></div>
<p>If using mbtree, pbratio doesn't do anything, so only test and set ipratio.</p>
<h3 id="psychovisually-optimized-rate-distortion-optimization">Psychovisually optimized rate-distortion optimization</h3>
<p>One big issue with immature encoders is that they don't offer psychovisual optimizations like psy-rdo.
What it does is distort the frame slightly, sharpening it in the process.
This will make it statistically less similar to the original frame, but will look better and more similar to the input.
What this means is this is a weak sharpener of sorts, but a very much necessary sharpener!</p>
<p>The setting in x264 comes with two options, psy-rdo and psy-trellis, which are both set via the same option:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-14-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a>--psy-rd<span style="color: #ABB2BF"> </span>rdo:trellis
</code></pre></div></td></tr></table></div>
<p>Unfortunately, the latter will usually do more harm than good, so it's best left off.
The psy-rdo strength should be higher for sharper content and lower for blurrier content. For animated content, psy-rdo can introduce ringing even with default values. We suggest using lower values, between  <code>0.60</code> and <code>0.90</code>. For live action content where this is of much lesser concern you should find success with values around <code>0.95</code> to <code>1.10</code>.</p>
<p>When testing this, pay attention to whether content looks sharp enough or too sharp, as well as whether anything gets distorted during the sharpening process.</p>
<p>For example, to set a psy-rd of 1.00 and psy-trellis of 0:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-15-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a>--psy-rd<span style="color: #ABB2BF"> </span><span style="color: #D19A66">1</span>.00:0
</code></pre></div></td></tr></table></div>
<h3 id="dct-block-decimation">DCT block decimation</h3>
<p>Disabling DCT block decimation (no-dct-decimate) is very common practice, as it drops blocks deemed unimportant.
This importance decision is made by checking if there are enough nonzero large coefficients, i.e. whether higher frequencies are present.
For high quality encoding, this is often unwanted and disabling this is wise.
However, for flatter content, leaving this on can aid with compression.
Just quickly test on and off if you're encoding something flat.</p>
<p>To disable DCT block decimation:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a>--no-dct-decimate
</code></pre></div></td></tr></table></div>
<h3 id="video-buffer-verifier">Video buffer verifier</h3>
<p>To understand what this is, there's actually a <a href="https://en.wikipedia.org/wiki/Video_buffering_verifier">Wikipedia article you can read</a>. Alternatively, you may find <a href="https://www.youtube.com/watch?v=-Q7BuSXdO_8">this video presentation</a> from demuxed informative.</p>
<p>For us, the main relevance is that we want to disable this when testing settings, as video encoded with VBV enabled will be non-deterministic.
Otherwise, just leave it at your level's defaults.</p>
<p>To disable VBV:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a>--vbv-bufsize<span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF"> </span>--vbv-maxrate<span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span>
</code></pre></div></td></tr></table></div>
<p>VBV settings for general hardware compliance (High@L4.1)</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-18-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>--vbv-bufsize<span style="color: #ABB2BF"> </span><span style="color: #D19A66">78125</span><span style="color: #ABB2BF"> </span>--vbv-maxrate<span style="color: #ABB2BF"> </span><span style="color: #D19A66">62500</span>
</code></pre></div></td></tr></table></div>
<h3 id="reference-frames">Reference frames</h3>
<p>The reference frames (ref) setting determines how many frames P frames can use as reference. Many existing guides may provide an incorrect formula to find the 'correct' value. <strong>Do not use this</strong>. Rather, allow x264 to calculate this for automatically (as dictated by <code>--level</code>).</p>
<p>Otherwise, if you don't care about compatibility with 15 year old TVs and 30 year old receivers, set this however high you can bare, with a maximum value of 16.
Higher refs will improve encoder efficiency at the cost of increased compute time.</p>
<p>To set the maximum value of 16:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-19-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>--ref<span style="color: #ABB2BF"> </span><span style="color: #D19A66">16</span>
</code></pre></div></td></tr></table></div>
<h3 id="zones">Zones</h3>
<p>Sometimes, the encoder might have trouble distributing enough bits to certain frames, e.g. ones with wildly different visuals or sensitive to banding.
To help with this, one can zone out these scenes and change the settings used to encode them.</p>
<p>When using this to adjust bitrate, one can specify a CRF for the zone or a bitrate multiplier.
It's very important to not bloat these zones, e.g. by trying to maintain all the grain added while debanding.
Sane values tend to be Â±2 from base CRF or bitrate multipliers between <code>0.75</code> and <code>1.5</code>.</p>
<p>To specify a CRF of 15 for frames 100 through 200 and 16 for frames 300 through 400, as well as a bitrate multiplier of 1.5 for frames 500 through 600:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a>--zones<span style="color: #ABB2BF"> </span><span style="color: #D19A66">100</span>,200,crf<span style="color: #56B6C2">=</span><span style="color: #D19A66">15</span>/300,400,crf<span style="color: #56B6C2">=</span><span style="color: #D19A66">16</span>/500,600,b<span style="color: #56B6C2">=</span><span style="color: #D19A66">1</span>.5
</code></pre></div></td></tr></table></div>
<p>For a more complete picture of what --zones can and can not manipulate, see <a href="https://www.chaneru.com/Roku/HLS/X264_Settings.htm#zones">this section</a>.</p>
<h3 id="output-depth-and-color-space">Output depth and color space</h3>
<p>To encode 10-bit and/or 4:4:4 video, one must specify this via the following parameters:</p>
<div class="highlight" style="background: #282C34"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a>--output-depth<span style="color: #ABB2BF"> </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF"> </span>--output-csp<span style="color: #ABB2BF"> </span>i444
</code></pre></div></td></tr></table></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.expand"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>